{% extends 'product_service/template.html' %}

{% load static %}

{% block title %} {{user.name}} Listings | Go&Buy {% endblock %}

{% block container %}
	<div>
		<h2>My listings</h2>
		{% for listing in page_obj %}
			<a class="container d-flex shadow rounded my-3 listing-container align-items-center justify-content-between"
			   href="{% url 'listing-details' listing.pk %}">
				<div class="listing-review d-flex">
					<div class="listing-image">
						{% with main_image=listing.product_images.first %}
							{% if main_image %}
								<img src="{{ main_image.image.url }}" alt="{{ listing.product_name }} image"
									 class="rounded">
							{% else %}
								<img src="{% static 'product_service/images/no_image.png' %}"
									 alt="{{ listing.product_name }} image"
									 class="rounded">
							{% endif %}
						{% endwith %}
					</div>
					<div class="listing-review-info mx-3 d-flex flex-column justify-content-center">
						<h2>{{ listing.product_name }}</h2>
						<p class="review-category">
							<span class="badge text-bg-primary">Category:</span>
							{{ listing.category }}
						</p>
					</div>
				</div>
				<div class="listing-review-price">
					<h1>{{ listing.cost|floatformat:1 }}$</h1>
				</div>
			</a>
		{% empty %}
			<div class="alert alert-danger mt-3 text-center" role="alert">
				No products found!
			</div>
		{% endfor %}

		{% if page_obj.has_other_pages %}
			<nav aria-label="Page navigation">
				<ul class="pagination justify-content-center mt-3">
					{% if page_obj.has_previous %}
						<li class="page-item">
							<a class="page-link" href="?page={{ page_obj.previous_page_number }}" aria-label="Previous">
								<span aria-hidden="true">&laquo;</span>
							</a>
						</li>
					{% else %}
						<li class="page-item disabled">
							<span class="page-link">&laquo;</span>
						</li>
					{% endif %}

					{% for num in page_obj.paginator.page_range %}
						{% if page_obj.number == num %}
							<li class="page-item active" aria-current="page">
								<span class="page-link">{{ num }}</span>
							</li>
						{% else %}
							<li class="page-item">
								<a class="page-link" href="?page={{ num }}">{{ num }}</a>
							</li>
						{% endif %}
					{% endfor %}

					{% if page_obj.has_next %}
						<li class="page-item">
							<a class="page-link" href="?page={{ page_obj.next_page_number }}" aria-label="Next">
								<span aria-hidden="true">&raquo;</span>
							</a>
						</li>
					{% else %}
						<li class="page-item disabled">
							<span class="page-link">&raquo;</span>
						</li>
					{% endif %}
				</ul>
			</nav>
		{% endif %}
	</div>
{% endblock %}